library(data.table)
grocerry=fread("grocerry.txt")
consultant = fread("consultant.txt")
setwd("../../..")
getwd()
setwd("R")
getwd()
consultant = fread("consultant.txt")
apt_test=fread("tests.txt")
lm(y~x1,data=consultant[consultant$x2==0])
lm(y~x1,data=consultant[consultant$x2==1])
setnames(grocerry,c("y","x1","x2"))
grocerry
setnames(grocerry,c("y","x1","x2","x3"))
consultant
setnames(consultant,c("y","x1","x2","x3"))
setnames(consultant,c("y","x1","x2"))
consultant
setnames(apt_test,c("y","x1","x2","x3","x4"))
apt_test
model1=lm(y~x1+x3+x2,data=grocerry)
anova(model1)
plot(consultant$x1,consultant$y)
abline(lm(y~x1,data=consultant[consultant$x2==1]),col="green")
abline(lm(y~x1,data=consultant[consultant$x2==0]),col="red")
x_matirx=cor(grocerry)[2:4,2:4]
y_matrix=cor(grocerry)[1,2:4]
b_matrix=solve(x_matirx,y_matrix)
b_matrix
b_matrix[1,1]
b_matrix[1]
b_1=(sd(consultant$xy)/sd(consultant$x1))*b_matrix[1]
b_1
(sd(consultant$xy)/sd(consultant$x1))*b_matrix[1]
(sd(consultant$xy)/sd(consultant$x1))
(sd(consultant$y1)/sd(consultant$x1))
sd(consultant$y)
(sd(consultant$y)/sd(consultant$x1))
b_1=(sd(consultant$y)/sd(consultant$x1))*b_matrix[1]
b_1
b_2=(sd(consultant$y)/sd(consultant$x2))*b_matrix[2]
b_3=(sd(consultant$y)/sd(consultant$x3))*b_matrix[3]
b_0=mean(consultant$y)-(b_1*mean(consultant$x1))
b_1=(sd(grocerry$y)/sd(grocerry$x1))*b_matrix[1]
b_1
lm(y~x1+x2+x3,data=grocerry)
b_0=mean(grocerry$y)-(b_1*mean(grocerry$x1))-(b_2*mean(grocerry$x2))-(b_3*mean(grocerry$x3))
b_0
mean(grocerry$y)-(b_1*mean(grocerry$x1))-(b_2*mean(grocerry$x2))-(b_3*mean(grocerry$x3))
mean(grocerry$y)-(b_1*mean(grocerry$x1))
b_1=(sd(grocerry$y)/sd(grocerry$x1))*b_matrix[1]
b_2=(sd(grocerry$y)/sd(grocerry$x2))*b_matrix[2]
b_3=(sd(grocerry$y)/sd(grocerry$x3))*b_matrix[3]
b_0=mean(grocerry$y)-(b_1*mean(grocerry$x1))-(b_2*mean(grocerry$x2))-(b_3*mean(grocerry$x3))
b_0
for(n1 in 1:4){
l1model=summary(lm(y~get(paste0("x",n1)),data=apt_test))
l1coef=l1model$coefficients[2,3]
l1pvalues=l1model$coefficients[2,4]
print(paste(paste0("x",n1),l1coef,l1pvalues))
}
for(n1 in 2:4){
l1model=summary(lm(y~x1+get(paste0("x",n1)),data=apt_test))
l1coef=l1model$coefficients[2,3]
l1pvalues=l1model$coefficients[2,4]
l2coef=l1model$coefficients[3,3]
l2pvalues=l1model$coefficients[3,4]
print(paste(paste0("x1",",x",n1),l1coef,l1pvalues,l2coef,l2pvalues))
}
?step
step(lm(y~1),scope=c("x1","x2","x3","x4"),direction = c("forward"))
step(lm(y~1,data=apt_test),scope=c("x1","x2","x3","x4"),direction = c("forward"))
apt_test
step(lm(y~1,data=apt_test),direction = c("forward"))
step(lm(y~x1+x2+x3+x4,data=apt_test),direction = c("forward"))
step(lm(y~,data=apt_test),direction = c("forward"))
step(lm(y~.,data=apt_test),direction = c("forward"))
step(lm(y~x1,data=apt_test),direction = c("forward"))
null=lm(y~1,data=apt_test)
lm(y~.,data=apt_test)
full=lm(y~.,data=apt_test)
step(null,scope=list(lower=null,upper=full),direction = "forward")
?add1
add1(null,scope = c("x1","x2","x3","x4"),test="F")
add1(lm(y~x3,data=apt_test),scope = c("x1","x2","x3","x4"),test="F")
add1(lm(y~x3,data=apt_test),scope = c("x1","x2","x4"),test="F")
add1(lm(y~x3+x1,data=apt_test),scope = c("x2","x4"),test="F")
add1(lm(y~x3+x1+x4,data=apt_test),scope = c("x2","x4"),test="F")
add1(lm(y~x3+x1+x4,data=apt_test),scope = c("x2"),test="F")
add1(null,scope = c("x1","x2","x3","x4"),test="F")
# x3 has highest F Value and lowest P Value
add1(lm(y~x3,data=apt_test),scope = c("x1","x2","x4"),test="F")
add1(lm(y~x3+x1,data=apt_test),scope = c("x2","x4"),test="F")
add1(lm(y~x3+x1+x4,data=apt_test),scope = c("x2"),test="F")
add1(null,scope = c("x1","x2","x3","x4"),test="F")
add1(lm(y~x3+x1+x4,data=apt_test),scope = c("x2"),test="F")
qf(0.95,df=1,df=60)
qf(0.95,df=1,df2 = =60)
qf(0.95,df=1,df2=60)
qf(0.95,df=3,df2=60)
for(n1 in 1:2){
for(n2 in (n1+1):3){
for(n3 in (n2+1):4){
print(paste(paste0("x",n1,",x",n2,",x",n3),(summary(lm(y~get(paste0("x",n1))+get(paste0("x",n2))+get(paste0("x",n3)),data=apt_test))$adj.r.squared)))
}}}
model921=lm(y~x3+x1+x4,data=apt_test)
model921
PRESS_v <- function(model) {
pr = residuals(model)/(1-lm.influence(model)$hat)
PRESS <- sum(pr^2)
return(PRESS)
}
PRESS_v(model921)
m123=summary(model921)
m123$coefficients
m123$fstatistic
m123
anova(model921)
anova(model921)$Residuals
m123=anova(model921)
m123$`Sum Sq`
apt_test_valdiate=fread("t2.txt")
setnames(apt_test_valdiate,c("y","x1","x2","x3","x4"))
apt_test_valdiate
cor(apt_test)
cor(apt_test_valdiate)
lm(y~x3+x1+x4,data=apt_test_valdiate)
lm(y~x3+x1+x4,data=apt_test)
model9221 = lm(y~x3+x1+x4,data=apt_test_valdiate)
model9222 = lm(y~x3+x1+x4,data=apt_test_valdiate)
anova(model9221)
anova(model9222)
model9221 = lm(y~x3+x1+x4,data=apt_test_valdiate)
model9222 = lm(y~x3+x1+x4,data=apt_test)
model9221
model9222
anova(model9222)
anova(model9221)
summary(model9221)
summary(model9222)
model9221$coefficients
model9222$coefficients
apt_test
apt_test_valdiate
model9222$coefficients
model9221$coefficients
PRESS_v(lm(y~x3+x1))
PRESS_v(lm(y~x3+x1),data=apt_test)
PRESS_v(lm(y~x3+x1,data=apt_test))
summary(model9221)
sd(apt_test_valdiate$x1)
ncol(apt_test_valdiate)
nrow(apt_test_valdiate)
19.99/24
19.99/25
apt_test_valdiate[,2:5]
apt_test_valdiate[,2:5]
apt_test_valdiate[,2]
apt_test_valdiate
apt_test_valdiate[1:25,2:5]
apt_test_valdiate["x1"]
apt_test_valdiate[,"x1"]
apt_test_valdiate
apt_test_valdiate[2,10]
apt_test_valdiate[2,1]
apt_test_valdiate[2,1:5]
vcov(model9221)
vcov(model9222)
vcov(model9222)
anm123=anova(model9221)
anm123$`Mean Sq`
anova(model9221)$`Mean Sq`
anova(model9222)$`Mean Sq`
anova(model9222)$r-squared
m13=summary(model9221)
m13$r.squared
summary(model9221)$r.squared
summary(model9222)$r.squared
anova(model9222)
model9222$df.residual/nrow(apt_test_valdiate)
model9222$df.residual
model9222$residuals
summary(model9221)
anova(model9221)
385.5/25
anova(lm(y~x3+x1,data=apt_test_valdiate))
PRESS_v(lm(y~x3+x1,data=apt_test_valdiate))
PRESS_v(lm(y~x3+x4,data=apt_test_valdiate))
PRESS_v(lm(y~x3+x4,data=apt_test))
PRESS_v(lm(y~x3+x1,data=apt_test))
anova(lm(y~x3+x1,data=apt_test_valdiate))
summary(lm(y~x3+x1,data=apt_test_valdiate))$residuals
sum((summary(lm(y~x3+x1,data=apt_test_valdiate))$residuals)^2)
predict.lm(model9222,apt_test_valdiate)
summary(predict.lm(model9222,apt_test_valdiate))
apt_test_validate$y-predict.lm(model9222,apt_test_valdiate)
y1_pred=predict.lm(model9222,apt_test_valdiate)
apt_test_valdiate$y-y1_pred
sum((apt_test_valdiate$y-y1_pred)^2)
y1_pred=predict.lm(lm(y~x3+x1,data=apt_test),apt_test_valdiate)
sum((apt_test_valdiate$y-y1_pred)^2)
test112=apt_test+apt_test_valdiate
lm(y~x3+x1,data=test112)
lm(y~x3+x1+x4,data=test112)
vcov(lm(y~x3+x1+x4,data=test112))
vcov(model9222)
anova(lm(y~x3+x1+x4,data=test112))
summary(lm(y~x3+x1+x4,data=test112))
summary(model9222)
summary(model9222)$coefficients
summary(lm(y~x3+x1+x4,data=test112))$coeeficients
summary(lm(y~x3+x1+x4,data=test112))$coeficients
summary(lm(y~x3+x1+x4,data=test112))$coefficients
summary(lm(y~x3+x1,data=test112))$coefficients
vcov(lm(y~x3+x1,data=test112))
(lm(y~x3+x1,data=test112))
(lm(y~x+x3,data=test112))
(lm(y~x1+x3,data=test112))
test112
test112=merge(apt_test,apt_test_valdiate)
test112=merge(apt_test,apt_test_valdiate,all)
test112=merge(apt_test,apt_test_valdiate,all=TRUE)
test=data.frame(apt_test,apt_test_valdiate)
test
rbind(apt_test,apt_test_valdiate)
test112=rbind(apt_test,apt_test_valdiate)
lm(y~x3+x1,data=test112)
vcov(lm(y~x3+x1+x4,data=test112))
vcov(model9222)
add1(null,scope = c("x1","x2","x3","x4"),test="F")
# x3 has highest F Value and lowest P Value
add1(lm(y~x3,data=apt_test),scope = c("x1","x2","x4"),test="F")
add1(lm(y~x3+x1,data=apt_test),scope = c("x2","x4"),test="F")
add1(lm(y~x3+x1+x4,data=apt_test),scope = c("x2"),test="F")
add1(lm(y~x3+x1,data=apt_test),scope = c("x2","x4"),test="F")
qf(0.95,2,25-3)
stem(apt_test,scale=10)
stem(apt_test$y,scale=10)
stem(apt_test$x1,scale=10)
stem(apt_test$x2,scale=10)
stem(apt_test$x3,scale=10)
plot(apt_test)
boxplot(apt_test$y)
boxplot(apt_test$x1)
boxplot(apt_test$x2)
boxplot(apt_test$x3)
boxplot(apt_test$x4)
boxplot(apt_test$x3)
boxplot(apt_test$x2)
boxplot(apt_test$x1)
boxplot(apt_test$x3)
stem(apt_test$x3,scale=10)
stem(apt_test$x4,scale=10)
stem(apt_test$x2,scale=10)
stem(apt_test$x1,scale=10)
stem(apt_test$x3,scale=10)
stem(apt_test$x1,scale=10)
plot(apt_test)
cor(apt_test)
apt_model=lm(y~x1+x2+x3+x4,data=apt_test)
summary(apt_model)
anova(apt_model)
mspr=sum((apt_test_valdiate$y-y1_pred)^2)/nrow(apt_test_validate)\
um((apt_test_valdiate$y-y1_pred)^2)/
um((apt_test_valdiate$y-y1_pred)^2)/
/
sum((apt_test_valdiate$y-y1_pred)^2)
sum((apt_test_valdiate$y-y1_pred)^2)/50
sum((apt_test_valdiate$y-y1_pred)^2)/25
anova(lm(y~x3+x1,data=apt_test))
sum((apt_test_valdiate$y-y1_pred)^2)
y1_pred=predict.lm(lm(y~x3+x1+x4,data=apt_test),apt_test_valdiate)
mspr=sum((apt_test_valdiate$y-y1_pred)^2) / (nrow(apt_test_validate))
apt_test_valdiate
mspr=sum((apt_test_valdiate$y-y1_pred)^2) / (nrow(apt_test_validate))
(nrow(apt_test_valdiate))
sum((apt_test_valdiate$y-y1_pred)^2) / (nrow(apt_test_valdiate))
mspr=sum((apt_test_valdiate$y-y1_pred)^2) / (nrow(apt_test_valdiate))
anova(lm(y~x3+x1+x4,data=apt_test))
test112=rbind(apt_test,apt_test_valdiate)
pot(test112$y)
pot(test112$Y)
test112
plot(test112$x1,test112$y)
plot(test112)
vcov(model9221)
vcov(model9222)
for(n1 in 1:4){
print(summary(lm(y~get(paste0("x",n1)),data=apt_test))$adj.r.squared)
}
for(n1 in 1:4){
print(paste(paste0("x",n1),summary(lm(y~get(paste0("x",n1)),data=apt_test))$adj.r.squared))
}
