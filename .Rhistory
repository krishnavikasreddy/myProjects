setwd("Documents/projects/R")
library("data.table")
grocerry=fread("grocerry.txt")
setnames(grocerry,c("y","x1","x2","x3"))
model=lm(y~x1+x2+x3,data=grocerry)
summary(model)
x_value1=matrix(c(282000,7.1,0))
x_value1=data.frame(t(x_value1))
setnames(x_value1,c("x1","x2","x3"))
y_pred=predict.lm(model,x_value1)
y_pred
predict.lm(model,x_value1,interval = "confidence")
predict.lm(model,x_value1,interval = "confidence",level=0.95)
predict.lm(model,x_value1,interval = "confidence",level=0.975)
x_value1=matrix(c(282000,7.1,0))
x_value1=data.frame(t(x_value1))
setnames(x_value1,c("x1","x2","x3"))
y_pred=predict.lm(model,x_value1)
s2_y_hat=t(x_value)%*%s2b%*%x_value
s2_y=sqrt(s2_y_hat)
t_value=qt(0.975,48)
cat(y_pred-((t_value)*s2_y),"<= E{Y} <=",y_pred+((t_value)*s2_y))
x_value=matrix(c(282000,7.1,0))
x_value1=data.frame(t(x_value))
setnames(x_value1,c("x1","x2","x3"))
y_pred=predict.lm(model,x_value1)
s2_y_hat=t(x_value)%*%s2b%*%x_value
s2_y=sqrt(s2_y_hat)
t_value=qt(0.975,48)
cat(y_pred-((t_value)*s2_y),"<= E{Y} <=",y_pred+((t_value)*s2_y))
mse=20532
s2b=solve(t(xmatrix)%*%xmatrix)*mse
xmatrix=cbind(1,grocerry$x1,grocerry$x2,grocerry$x3)
mse=20532
s2b=solve(t(xmatrix)%*%xmatrix)*mse
x_value=matrix(c(282000,7.1,0))
x_value1=data.frame(t(x_value))
setnames(x_value1,c("x1","x2","x3"))
y_pred=predict.lm(model,x_value1)
s2_y_hat=t(x_value)%*%s2b%*%x_value
s2_y=sqrt(s2_y_hat)
t_value=qt(0.975,48)
cat(y_pred-((t_value)*s2_y),"<= E{Y} <=",y_pred+((t_value)*s2_y))
x_value=matrix(c(282000,7.1,0))
x_value1=data.frame(t(x_value))
setnames(x_value1,c("x1","x2","x3"))
y_pred=predict.lm(model,x_value1)
s2_y_hat=t(x_value)%*%s2b%*%x_value
s2_y=sqrt(s2_y_hat)
t_value=qt(0.975,48)
mse=20532
s2b=solve(t(xmatrix)%*%xmatrix)*mse
calculate_bonferroni_interval_mse=function(s2b,bon_t_value,x_value1,mse){
x_value=matrix(c(1,x_value1))
x_value1=data.frame(t(x_value1))
setnames(x_value1,c("x1","x2","x3"))
y_pred=predict.lm(model,x_value1)
s2_y_hat=(t(x_value)%*%s2b%*%x_value)+mse
s2_y=sqrt(s2_y_hat)
cat(y_pred-((bon_t_value)*s2_y),"<= Y_h <=",y_pred+((bon_t_value)*s2_y))
}
calculate_bonferroni_interval_mse(s2b,2.59,c(230000,7.5,0),mse)
calculate_bonferroni_interval_mse(s2b,2.59,c(250000,7.3,0),mse)
calculate_bonferroni_interval_mse(s2b,2.59,c(280000,7.1,0),mse)
calculate_bonferroni_interval_mse(s2b,2.59,c(340000,6.9,0),mse)
x_value=matrix(c(282000,7.1,0))
x_value1=data.frame(t(x_value))
x_value=matrix(c(1,282000,7.1,0))
setnames(x_value1,c("x1","x2","x3"))
y_pred=predict.lm(model,x_value1)
s2_y_hat=t(x_value)%*%s2b%*%x_value
s2_y=sqrt(s2_y_hat)
t_value=qt(0.975,48)
cat(y_pred-((t_value)*s2_y),"<= E{Y} <=",y_pred+((t_value)*s2_y))
x_value=matrix(c(282000,7.1,0))
x_value1=data.frame(t(x_value))
x_value=matrix(c(1,282000,7.1,0))
setnames(x_value1,c("x1","x2","x3"))
y_pred=predict.lm(model,x_value1)
s2_y_hat=t(x_value)%*%s2b%*%x_value
s2_y=sqrt(s2_y_hat)
print(s2_y)
t_value=qt(0.975,48)
print(t_value)
cat(y_pred-((t_value)*s2_y),"<= E{Y} <=",y_pred+((t_value)*s2_y))
summary(model)$sigma
x_value=matrix(c(282000,7.1,0))
x_value1=data.frame(t(x_value))
x_value=matrix(c(1,282000,7.1,0))
setnames(x_value1,c("x1","x2","x3"))
y_pred=predict.lm(model,x_value1)
s2_y_hat=((t(x_value)%*%s2b%*%x_value)+(0.33))*mse
s2_y=sqrt(s2_y_hat)
print(s2_y)
t_value=qt(0.975,48)
print(t_value)
cat(y_pred-((t_value)*s2_y),"<= E{Y} <=",y_pred+((t_value)*s2_y))
x_value=matrix(c(282000,7.1,0))
x_value1=data.frame(t(x_value))
x_value=matrix(c(1,282000,7.1,0))
setnames(x_value1,c("x1","x2","x3"))
y_pred=predict.lm(model,x_value1)
s2_y_hat=((t(x_value)%*%s2b%*%x_value)*(mse/3)
s2_y=sqrt(s2_y_hat)
print(s2_y)
t_value=qt(0.975,48)
print(t_value)
cat(y_pred-((t_value)*s2_y),"<= E{Y} <=",y_pred+((t_value)*s2_y))
mse
mse/3
s2_y_hat=(t(x_value)%*%s2b%*%x_value))*6844
s2_y=sqrt(s2_y_hat)
s2_y_hat=(t(x_value)%*%s2b%*%x_value))*6844
s2_y=sqrt(s2_y_hat)
s2_y_hat=t(x_value)%*%s2b%*%x_value*6844
s2_y
s2_y_hat
sqrt(s2_y_hat)
x_value=matrix(c(282000,7.1,0))
x_value1=data.frame(t(x_value))
x_value=matrix(c(1,282000,7.1,0))
setnames(x_value1,c("x1","x2","x3"))
y_pred=predict.lm(model,x_value1)
s2_y_hat=(t(x_value)%*%s2b%*%x_value))+6844
s2_y=sqrt(s2_y_hat)
print(s2_y)
t_value=qt(0.975,48)
print(t_value)
cat(y_pred-((t_value)*s2_y),"<= E{Y} <=",y_pred+((t_value)*s2_y)
q
s2_y_hat=(t(x_value)%*%s2b%*%x_value))+6844
s2_y=sqrt(s2_y_hat)
s2_y_hat=(t(x_value)%*%s2b%*%x_value)+6844
s2_y=sqrt(s2_y_hat)
s2_y_hat=(t(x_value)%*%s2b%*%x_value)+6844
s2_y=sqrt(s2_y_hat)
s2_y
summary(mode)$sigma
summary(model)$sigma
summary(model)$mean
mean(grocerry$y)
sd(grocerry$y)
x_value=matrix(c(282000,7.1,0))
x_value1=data.frame(t(x_value))
x_value=matrix(c(1,282000,7.1,0))
setnames(x_value1,c("x1","x2","x3"))
y_pred=predict.lm(model,x_value1)
s2_y_hat=(t(x_value)%*%s2b%*%x_value))+6844
s2_y=sqrt(s2_y_hat)
print(s2_y)
t_value=qt(0.975,48)
print(t_value)
cat(y_pred-((t_value)*s2_y),"<= Y_H <=",y_pred+((t_value)*s2_y))
3*4105.807
cat(y_pred-((t_value)*s2_y)*3,"<= Y_H*3 <=",y_pred+((t_value)*s2_y)*3)
cat((y_pred-((t_value)*s2_y))*3,"<= Y_H*3 <=",(y_pred+((t_value)*s2_y))*3)
summary(model)
qf(0.95,4,48)
plot.ts(c(grocerry$x2,7.2))
plot.ts(c(grocerry$x2,9.9))
boxplot(c(grocerry$x2,7.2))
boxplot(c(grocerry$x2,9.9))
boxplot(c(grocerry$x1,400000),c(grocerry$x2,9.9))
boxplot(c(grocerry$x1,400000))
boxplot(c(grocerry$x2,9.9))
y_hat_values=fitted(model)
plot(y_hat_values,residuals_model)
residuals_model=resid(model)
y_hat_values=fitted(model)
plot(y_hat_values,residuals_model)
x1_x2=c(grocerry$x1*grocerry$x2)
plot(x1_x2,residuals_model)
A_matrix=matrix(c(1,1,1,1,-1,0,1,-1,-1),nrow=3,ncol=3)
A_matrix
A_matrix=matrix(t(c(1,1,1,1,-1,0,1,-1,-1)),nrow=3,ncol=3)
A_matrix
A_matrix=t(matrix(c(1,1,1,1,-1,0,1,-1,-1),nrow=3,ncol=3))
A_matrix
W_matrix=matrix(c("w1","w2","w3"))
W_matrix
